// server.js - CosmoDance Chat Bot v2.3
import express from "express";
import cors from "cors";
import dotenv from "dotenv";
import fs from "fs";
import path from "path";
import { fileURLToPath } from "url";

// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à–∏ –º–æ–¥—É–ª–∏
import DeepSeekAI from "./deepseek-ai.js";
import CosmoParser from "./cosmo-parser.js";

dotenv.config();

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
const app = express();

// Middleware
app.use(cors());
app.use(express.json({ limit: "100kb" }));
app.use(express.static(__dirname));

// ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ï–†–í–ò–°–û–í ============
let aiClient = null;
try {
  if (process.env.DEEPSEEK_API_KEY && process.env.DEEPSEEK_API_KEY.length > 20) {
    aiClient = new DeepSeekAI(process.env.DEEPSEEK_API_KEY);
    console.log('ü§ñ DeepSeek AI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
  } else {
    console.log('‚ö†Ô∏è DeepSeek API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π');
  }
} catch (error) {
  console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ AI:', error.message);
}

const cosmoParser = new CosmoParser();

// ============ –ó–ê–ì–†–£–ó–ö–ê –ë–ê–ó–´ –ó–ù–ê–ù–ò–ô ============
function loadKnowledge() {
  try {
    const data = fs.readFileSync("knowledge.json", "utf8");
    return JSON.parse(data);
  } catch (error) {
    console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ knowledge.json:", error.message);
    return { docs: [] };
  }
}

const KNOWLEDGE = loadKnowledge();
console.log(`üìö –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${KNOWLEDGE.docs?.length || 0} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π`);

// ============ –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
function buildKnowledgeText() {
  if (!KNOWLEDGE.docs || !Array.isArray(KNOWLEDGE.docs)) {
    return "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.";
  }
  
  let text = "## –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π CosmoDance\n\n";
  KNOWLEDGE.docs.forEach(doc => {
    text += `### ${doc.title}\n${doc.text}\n\n`;
  });
  return text;
}

async function getScheduleContext(branch = null) {
  try {
    const schedule = await cosmoParser.getClientSchedule(branch);
    
    if (!schedule || Object.keys(schedule).filter(k => !k.startsWith('_')).length === 0) {
      return "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Å–∞–π—Ç–µ: https://cosmo.su/raspisanie/";
    }

    let scheduleText = "## üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π (–≥—Ä—É–ø–ø—ã –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö)\n\n";
    
    // –£–±–∏—Ä–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—ã–≤–æ–¥–∞
    const scheduleData = { ...schedule };
    if (scheduleData._meta) {
      delete scheduleData._meta;
    }

    // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∏–ª–∏–∞–ª
    if (branch) {
      const branchNames = Object.keys(scheduleData).filter(k => !k.startsWith('_'));
      const foundBranch = branchNames.find(b => 
        b.toLowerCase().includes(branch.toLowerCase()) || 
        branch.toLowerCase().includes(b.toLowerCase())
      );
      
      if (foundBranch && scheduleData[foundBranch]) {
        scheduleText += `### üìç –§–∏–ª–∏–∞–ª: ${foundBranch}\n\n`;
        scheduleData[foundBranch].forEach((item, index) => {
          scheduleText += `${index + 1}. ${item}\n`;
        });
      } else {
        scheduleText += `### ‚ö†Ô∏è –§–∏–ª–∏–∞–ª "${branch}" –Ω–µ –Ω–∞–π–¥–µ–Ω\n\n`;
        scheduleText += "**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∏–ª–∏–∞–ª—ã:**\n";
        branchNames.forEach(b => {
          scheduleText += `‚Ä¢ ${b}\n`;
        });
      }
    } else {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ñ–∏–ª–∏–∞–ª—ã
      Object.entries(scheduleData).forEach(([branchName, items]) => {
        if (items && items.length > 0) {
          scheduleText += `### üìç ${branchName}\n\n`;
          items.slice(0, 4).forEach((item, index) => {
            scheduleText += `${index + 1}. ${item}\n`;
          });
          
          if (items.length > 4) {
            scheduleText += `... –∏ –µ—â—ë ${items.length - 4} –≥—Ä—É–ø–ø\n`;
          }
          scheduleText += '\n';
        }
      });
    }

    scheduleText += "---\n";
    scheduleText += "üéØ **–í—Å–µ –º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å —Å –Ω—É–ª—è!**\n";
    scheduleText += "üìÖ **–ê–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** https://cosmo.su/raspisanie/\n";
    scheduleText += "üìû **–ó–∞–ø–∏—Å—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è:** —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º\n";

    return scheduleText;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error.message);
    return "üìÖ –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: https://cosmo.su/raspisanie/";
  }
}

async function getPricesContext() {
  try {
    const prices = await cosmoParser.getPrices();
    
    if (!prices || Object.keys(prices).length === 0) {
      return "üí∞ –¶–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Å–∞–π—Ç–µ: https://cosmo.su/prices/";
    }

    let pricesText = "## üí∞ –¶–µ–Ω—ã –∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã\n\n";
    
    Object.entries(prices).forEach(([category, content], index) => {
      if (category !== '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' && content) {
        pricesText += `### ${category}\n`;
        
        if (content.length > 300) {
          pricesText += `${content.substring(0, 300)}...\n\n`;
        } else {
          pricesText += `${content}\n\n`;
        }
      }
    });

    pricesText += "---\n";
    pricesText += "üí≥ **–û–ø–ª–∞—Ç–∞:** –Ω–∞–ª–∏—á–Ω—ã–µ, –∫–∞—Ä—Ç–∞, –æ–Ω–ª–∞–π–Ω\n";
    pricesText += "üéÅ **–°–∫–∏–¥–∫–∏:** —Å–µ–º–µ–π–Ω—ã–µ, —Å—Ç—É–¥–µ–Ω—Ç–∞–º, –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ 2+ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤\n";
    pricesText += "üîó **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã:** https://cosmo.su/prices/\n";

    return pricesText;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω:', error.message);
    return "üí∞ –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ü–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: https://cosmo.su/prices/";
  }
}

// ============ –°–ò–°–¢–ï–ú–ù–´–ô –ü–†–û–ú–ü–¢ ============
const SYSTEM_PROMPT = `–¢—ã ‚Äî –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å—Ç—É–¥–∏–∏ —Ç–∞–Ω—Ü–µ–≤ CosmoDance –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ.
–ò—Å–ø–æ–ª—å–∑—É–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.
–û—Ç–≤–µ—á–∞–π –≤–µ–∂–ª–∏–≤–æ, –≤—Å–µ–≥–¥–∞ –Ω–∞ "–≤—ã", –¥—Ä—É–∂–µ–ª—é–±–Ω–æ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ.

–í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:
1. –ü–æ–∫–∞–∑—ã–≤–∞–π —Ç–æ–ª—å–∫–æ –≥—Ä—É–ø–ø—ã –î–õ–Ø –ù–ê–ß–ò–ù–ê–Æ–©–ò–•
2. –¶–µ–Ω—ã –ø—Ä–∏–º–µ—Ä–Ω—ã–µ, —Ç–æ—á–Ω—ã–µ - —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –í—Å–µ–≥–¥–∞ —É–ø–æ–º–∏–Ω–∞–π –ø—Ä–æ —Å–∫–∏–¥–∫–∏
4. –ü—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –ø–ª–∞—Ç–Ω–æ–µ, –Ω–æ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –∞–±–æ–Ω–µ–º–µ–Ω—Ç

–°–¢–ò–õ–¨ –û–¢–í–ï–¢–û–í:
‚Ä¢ –ù–∞—á–∏–Ω–∞–π —Å —ç–º–æ–¥–∑–∏ üéØ üìÖ üí∞ üìç
‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å –∞–±–∑–∞—Ü–∞–º–∏
‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤
‚Ä¢ –ß–µ—Ç–∫–∏–µ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥–∏ (–∑–∞–ø–∏—Å—å, –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è)`;

// ============ –ú–ê–†–®–†–£–¢–´ API ============

// –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, "index.html"));
});

// –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
app.get("/debug", async (req, res) => {
  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä—Å–µ—Ä
    let parserStatus = { success: false, error: null };
    try {
      const testSchedule = await cosmoParser.getClientSchedule();
      parserStatus.success = true;
      parserStatus.branches = Object.keys(testSchedule).filter(k => !k.startsWith('_'));
      parserStatus.items = parserStatus.branches.reduce((sum, b) => {
        return sum + (testSchedule[b]?.length || 0);
      }, 0);
    } catch (error) {
      parserStatus.error = error.message;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º AI
    let aiStatus = { success: false, error: null };
    if (aiClient) {
      try {
        const testResponse = await aiClient.chat([
          { role: "user", content: "–ü—Ä–∏–≤–µ—Ç" }
        ], { maxTokens: 10 });
        aiStatus.success = true;
      } catch (error) {
        aiStatus.error = error.message;
      }
    }
    
    res.json({
      status: "diagnostics",
      timestamp: new Date().toISOString(),
      environment: {
        NODE_ENV: process.env.NODE_ENV || 'production',
        PORT: process.env.PORT || 10000,
        HOST: process.env.HOST || '0.0.0.0',
        DEEPSEEK_KEY_LENGTH: process.env.DEEPSEEK_API_KEY?.length || 0
      },
      parser: parserStatus,
      ai: aiStatus,
      knowledge_base: {
        docs_count: KNOWLEDGE.docs?.length || 0
      },
      suggestions: [
        parserStatus.success ? "‚úÖ –ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç" : "‚ùå –ü–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: " + parserStatus.error,
        aiClient ? "‚úÖ AI –¥–æ—Å—Ç—É–ø–µ–Ω" : "‚ùå AI –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–µ—Ç API –∫–ª—é—á–∞)",
        aiStatus.success ? "‚úÖ AI –æ—Ç–≤–µ—á–∞–µ—Ç" : "‚ùå AI –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç: " + aiStatus.error
      ]
    });
    
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–∞–π—Ç–æ–º
app.get("/test-connection", async (req, res) => {
  try {
    const axios = (await import('axios')).default;
    const response = await axios.get('https://cosmo.su', {
      timeout: 5000,
      headers: {
        'User-Agent': 'CosmoDanceBot-Test/1.0'
      }
    });
    
    res.json({
      success: true,
      status: response.status,
      size: response.data.length,
      firstLine: response.data.split('\n')[0]
    });
  } catch (error) {
    res.json({
      success: false,
      error: error.message,
      code: error.code
    });
  }
});

// –ß–∞—Ç —Å –±–æ—Ç–æ–º
app.post("/chat", async (req, res) => {
  try {
    const { message } = req.body;
    const userMessage = (message || "").trim();
    
    if (!userMessage) {
      return res.json({
        reply: "üëã –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –æ —Å—Ç—É–¥–∏–∏ CosmoDance."
      });
    }

    console.log(`üì® –ó–∞–ø—Ä–æ—Å: "${userMessage}"`);

    // –†–ê–°–®–ò–†–ï–ù–ù–´–ï –õ–û–ö–ê–õ–¨–ù–´–ï –û–¢–í–ï–¢–´
    const enhancedResponses = {
      // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
      '–ø—Ä–∏–≤–µ—Ç': 'üëã –ü—Ä–∏–≤–µ—Ç! –Ø —á–∞—Ç-–±–æ—Ç —Å—Ç—É–¥–∏–∏ —Ç–∞–Ω—Ü–µ–≤ CosmoDance. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?',
      '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ': 'üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å—Ç—É–¥–∏–∏ CosmoDance.',
      '–¥–æ–±—Ä—ã–π –¥–µ–Ω—å': 'üëã –î–æ–±—Ä—ã–π –¥–µ–Ω—å! –†–∞–¥ –≤–∞—Å –≤–∏–¥–µ—Ç—å –≤ —Å—Ç—É–¥–∏–∏ CosmoDance!',
      '–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ': 'üëã –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! –ì–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.',
      '–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä': 'üëã –î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?',
      
      // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
      '—Å–∞–π—Ç': 'üåê **–ù–∞—à —Å–∞–π—Ç:** https://cosmo.su/\n' +
             '–ó–¥–µ—Å—å –Ω–∞–π–¥–µ—Ç–µ:\n' +
             '‚Ä¢ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π\n' +
             '‚Ä¢ –¶–µ–Ω—ã –∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã\n' +
             '‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã —Ñ–∏–ª–∏–∞–ª–æ–≤\n' +
             '‚Ä¢ –§–æ—Ç–æ –∏ –≤–∏–¥–µ–æ —Å –∑–∞–Ω—è—Ç–∏–π',
      
      '—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ': 'üìÖ **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ CosmoDance:**\n\n' +
                   'üéØ **–ì—Ä—É–ø–ø—ã –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö** –µ—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!\n\n' +
                   'üìç **–§–∏–ª–∏–∞–ª—ã:**\n' +
                   '‚Ä¢ –ó–≤—ë–∑–¥–Ω–∞—è\n' +
                   '‚Ä¢ –î—ã–±–µ–Ω–∫–æ\n' +
                   '‚Ä¢ –ö—É–ø—á–∏–Ω–æ\n' +
                   '‚Ä¢ –û–∑–µ—Ä–∫–∏\n\n' +
                   'üîó **–ê–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** https://cosmo.su/raspisanie/\n' +
                   'üìû **–ó–∞–ø–∏—Å—å:** —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º',
      
      '—Ü–µ–Ω—ã': 'üí∞ **–¶–µ–Ω—ã CosmoDance:**\n\n' +
             'üé´ **–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã:**\n' +
             '‚Ä¢ 4 –∑–∞–Ω—è—Ç–∏—è: 3500-4500‚ÇΩ\n' +
             '‚Ä¢ 8 –∑–∞–Ω—è—Ç–∏–π: 6000-8000‚ÇΩ\n' +
             '‚Ä¢ 12 –∑–∞–Ω—è—Ç–∏–π: 8500-10000‚ÇΩ\n\n' +
             'üéÅ **–°–∫–∏–¥–∫–∏:** —Å—Ç—É–¥–µ–Ω—Ç–∞–º, —Å–µ–º–µ–π–Ω—ã–º –ø–∞—Ä–∞–º\n' +
             'üíé **–ü—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ:** 1000‚ÇΩ\n\n' +
             'üîó **–í—Å–µ —Ü–µ–Ω—ã:** https://cosmo.su/prices/',
      
      // –¶–ï–ù–´ –ò –ê–ë–û–ù–ï–ú–ï–ù–¢–´
      '—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç': 'üí∞ **–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏–π –≤ CosmoDance:**\n\n' +
                      'üéØ **–î–ª—è –ù–ê–ß–ò–ù–ê–Æ–©–ò–•:**\n' +
                      '‚Ä¢ –ê–±–æ–Ω–µ–º–µ–Ω—Ç 8 –∑–∞–Ω—è—Ç–∏–π: 6000-8000‚ÇΩ\n' +
                      '‚Ä¢ –†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ: 1000-1500‚ÇΩ\n' +
                      '‚Ä¢ –ü—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ: 1000‚ÇΩ (–∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –∞–±–æ–Ω–µ–º–µ–Ω—Ç)\n\n' +
                      'üèÜ **–í—ã–≥–æ–¥–Ω–µ–µ –≤—Å–µ–≥–æ:**\n' +
                      '‚Ä¢ –ö—É–ø–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 12 –∑–∞–Ω—è—Ç–∏–π\n' +
                      '‚Ä¢ –ü—Ä–∏–≤–µ—Å—Ç–∏ –¥—Ä—É–≥–∞ (—Å–∫–∏–¥–∫–∞ 10% –æ–±–æ–∏–º)\n' +
                      '‚Ä¢ –°–µ–º–µ–π–Ω–∞—è —Å–∫–∏–¥–∫–∞ 15%\n\n' +
                      'üìû **–¢–æ—á–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å** —É—Ç–æ—á–Ω—è–π—Ç–µ —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞',
      
      '–∞–±–æ–Ω–µ–º–µ–Ω—Ç': 'üé´ **–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã CosmoDance:**\n\n' +
                  '–£ –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:\n\n' +
                  '1. **–ù–∞ 4 –∑–∞–Ω—è—Ç–∏—è** - –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å\n' +
                  '2. **–ù–∞ 8 –∑–∞–Ω—è—Ç–∏–π** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç\n' +
                  '3. **–ù–∞ 12 –∑–∞–Ω—è—Ç–∏–π** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã–≥–æ–¥–∞\n\n' +
                  'üí∞ **–¶–µ–Ω—ã:**\n' +
                  '‚Ä¢ 4 –∑–∞–Ω—è—Ç–∏—è: –æ—Ç 3500‚ÇΩ\n' +
                  '‚Ä¢ 8 –∑–∞–Ω—è—Ç–∏–π: –æ—Ç 6000‚ÇΩ\n' +
                  '‚Ä¢ 12 –∑–∞–Ω—è—Ç–∏–π: –æ—Ç 8500‚ÇΩ\n\n' +
                  '‚è∞ **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:** 30 –¥–Ω–µ–π\n' +
                  '‚ùÑÔ∏è **–ú–æ–∂–Ω–æ –∑–∞–º–æ—Ä–æ–∑–∏—Ç—å** –Ω–∞ 14 –¥–Ω–µ–π\n\n' +
                  'üîó **–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** https://cosmo.su/prices/',
      
      // –§–∏–ª–∏–∞–ª—ã
      '–∞–¥—Ä–µ—Å': 'üìç **–ù–∞—à–∏ —Ñ–∏–ª–∏–∞–ª—ã –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ:**\n\n' +
              '1. **–ó–≤—ë–∑–¥–Ω–∞—è**\n' +
              '   ‚Ä¢ –ê–¥—Ä–µ—Å: —É–ª. –ó–≤—ë–∑–¥–Ω–∞—è\n' +
              '   ‚Ä¢ –ú–µ—Ç—Ä–æ: –ó–≤—ë–∑–¥–Ω–∞—è\n' +
              '2. **–î—ã–±–µ–Ω–∫–æ**\n' +
              '   ‚Ä¢ –ê–¥—Ä–µ—Å: —É–ª. –î—ã–±–µ–Ω–∫–æ\n' +
              '   ‚Ä¢ –ú–µ—Ç—Ä–æ: –ü—Ä–æ—Å–ø–µ–∫—Ç –ë–æ–ª—å—à–µ–≤–∏–∫–æ–≤\n' +
              '3. **–ö—É–ø—á–∏–Ω–æ**\n' +
              '   ‚Ä¢ –ê–¥—Ä–µ—Å: —Ä–∞–π–æ–Ω –ö—É–ø—á–∏–Ω–æ\n' +
              '   ‚Ä¢ –ú–µ—Ç—Ä–æ: –ö—É–ø—á–∏–Ω–æ\n' +
              '4. **–û–∑–µ—Ä–∫–∏**\n' +
              '   ‚Ä¢ –ê–¥—Ä–µ—Å: —Ä–∞–π–æ–Ω –û–∑–µ—Ä–∫–∏\n' +
              '   ‚Ä¢ –ú–µ—Ç—Ä–æ: –û–∑–µ—Ä–∫–∏\n\n' +
              'üîó **–¢–æ—á–Ω—ã–µ –∞–¥—Ä–µ—Å–∞:** https://cosmo.su/contacts/',
      
      '—Ç–µ–ª–µ—Ñ–æ–Ω': 'üìû **–ö–æ–Ω—Ç–∞–∫—Ç—ã CosmoDance:**\n\n' +
                '**–ó–∞–ø–∏—Å—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è:**\n' +
                '‚Ä¢ –¢–µ–ª–µ—Ñ–æ–Ω: +7 (XXX) XXX-XX-XX\n' +
                '‚Ä¢ WhatsApp: +7 (XXX) XXX-XX-XX\n' +
                '‚Ä¢ Telegram: @cosmodance_bot\n\n' +
                'üîó **–í—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã:** https://cosmo.su/contacts/',
      
      // –ù–∞—á–∞–ª–æ –∑–∞–Ω—è—Ç–∏–π
      '–Ω–∞—á–∞—Ç—å': 'üéØ **–ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å –≤ CosmoDance:**\n\n' +
               '1. **–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∫–æ—Ç–æ—Ä–æ–µ –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è\n' +
               '2. **–ù–∞–π–¥–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π —Ñ–∏–ª–∏–∞–ª**\n' +
               '3. **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ** –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö\n' +
               '4. **–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ** (1000‚ÇΩ)\n' +
               '5. **–ü—Ä–∏—Ö–æ–¥–∏—Ç–µ –Ω–∞ –∑–∞–Ω—è—Ç–∏–µ** –≤ —É–¥–æ–±–Ω–æ–π –æ–¥–µ–∂–¥–µ\n\n' +
               'üìÖ **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** https://cosmo.su/raspisanie/\n' +
               'üí∞ **–¶–µ–Ω—ã:** https://cosmo.su/prices/',
      
      '–Ω–æ–≤–∏—á–æ–∫': 'üéØ **–î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ –≤ CosmoDance:**\n\n' +
                '‚úÖ **–ù–µ –Ω—É–∂–Ω–æ –Ω–∏–∫–∞–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏!**\n' +
                '‚úÖ **–í—Å–µ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –Ω—É–ª—è**\n' +
                '‚úÖ **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥** –∫ –∫–∞–∂–¥–æ–º—É\n' +
                '‚úÖ **–î—Ä—É–∂–µ–ª—é–±–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞**\n\n' +
                'üî• **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:**\n' +
                '‚Ä¢ Hip-Hop\n' +
                '‚Ä¢ Jazz Funk\n' +
                '‚Ä¢ High Heels\n' +
                '‚Ä¢ Latina\n' +
                '‚Ä¢ Twerk\n\n' +
                'üìÖ **–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ!**',
      
      // –ó–∞–ø–∏—Å—å
      '–∑–∞–ø–∏—Å–∞—Ç—å—Å—è': 'üìù **–ö–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∑–∞–Ω—è—Ç–∏—è:**\n\n' +
                   '**–°–ø–æ—Å–æ–±—ã –∑–∞–ø–∏—Å–∏:**\n' +
                   '1. **–ù–∞ —Å–∞–π—Ç–µ:** https://cosmo.su/ (—Ñ–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏)\n' +
                   '2. **–ü–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É:** +7 (XXX) XXX-XX-XX\n' +
                   '3. **–í —Å–æ—Ü—Å–µ—Ç—è—Ö:** Instagram, VK\n' +
                   '4. **–í —Å—Ç—É–¥–∏–∏:** –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –ª–∏—á–Ω–æ\n\n' +
                   'üéØ **–ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é:**\n' +
                   '‚Ä¢ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ\n' +
                   '‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Ñ–∏–ª–∏–∞–ª\n' +
                   '‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ—Å—å —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º\n\n' +
                   'üìÖ **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** https://cosmo.su/raspisanie/',
      
      // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      '–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω': 'üíÉ **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞–Ω—Ü–µ–≤ –≤ CosmoDance:**\n\n' +
                  'üéØ **–î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:**\n' +
                  '‚Ä¢ Hip-Hop (—Ö–∏–ø-—Ö–æ–ø)\n' +
                  '‚Ä¢ Jazz Funk (–¥–∂–∞–∑-—Ñ–∞–Ω–∫)\n' +
                  '‚Ä¢ Contemporary (–∫–æ–Ω—Ç–µ–º–ø–æ—Ä–∞—Ä–∏)\n' +
                  '‚Ä¢ High Heels (–≤—ã—Å–æ–∫–∏–µ –∫–∞–±–ª—É–∫–∏)\n' +
                  '‚Ä¢ Latina (–ª–∞—Ç–∏–Ω–∞)\n' +
                  '‚Ä¢ Twerk (—Ç–≤–µ—Ä–∫)\n' +
                  '‚Ä¢ Strip Dance (—Å—Ç—Ä–∏–ø-–ø–ª–∞—Å—Ç–∏–∫–∞)\n' +
                  '‚Ä¢ Break Dance (–±—Ä–µ–π–∫-–¥–∞–Ω—Å)\n\n' +
                  'üìÖ **–í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** https://cosmo.su/directions/',
      
      // –î–Ω–∏ –∏ –≤—Ä–µ–º—è
      '–∫–æ–≥–¥–∞': '‚è∞ **–ö–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç –∑–∞–Ω—è—Ç–∏—è:**\n\n' +
              '–ó–∞–Ω—è—Ç–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç **–∫–∞–∂–¥—ã–π –¥–µ–Ω—å** –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è:\n\n' +
              '‚Ä¢ **–£—Ç—Ä–µ–Ω–Ω–∏–µ:** —Å 9:00 –¥–æ 12:00\n' +
              '‚Ä¢ **–î–Ω–µ–≤–Ω—ã–µ:** —Å 14:00 –¥–æ 17:00\n' +
              '‚Ä¢ **–í–µ—á–µ—Ä–Ω–∏–µ:** —Å 18:00 –¥–æ 22:00\n\n' +
              'üéØ **–î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö** —á–∞—â–µ –≤—Å–µ–≥–æ –≤–µ—á–µ—Ä–Ω–∏–µ –≥—Ä—É–ø–ø—ã.\n' +
